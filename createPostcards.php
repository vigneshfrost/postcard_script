<?php
$option = "live"; //test
header('Content-Type: text/csv');
header('Content-Disposition: attachment; filename="sample.csv"');
file_put_contents("/home/mitesh/postcard_script/sample.csv", "");
$fp = fopen('/home/mitesh/postcard_script/sample.csv', 'a');
$csvData = array(
	'slashtag' => 'slashtag',
	'destination_url'  =>  'destination_url'
);
fputcsv($fp, $csvData);
fclose($fp);

file_put_contents("/home/mitesh/postcard_script/template_urls.csv", "");
$fp1 = fopen('/home/mitesh/postcard_script/template_urls.csv', 'a');
$csvData1 = array(
	'name' => 'Name',
	'url'  =>  'URL',
	'template'  =>  'Template ID'
);
fputcsv($fp1, $csvData1);
fclose($fp1);

file_put_contents("/home/mitesh/postcard_script/leads.csv", "");
file_put_contents("/home/mitesh/postcard_script/filtered_leads.csv", "");
$fp2 = fopen('/home/mitesh/postcard_script/leads.csv', 'a');
$csvData2 = array(
	'id' => 'Lead ID',
	'status' => 'Status',
	'address' => 'Address',
	'city_name' => 'City Name',
	'state_name' => 'State Name',
	'zip_code' => 'Zip Code',
	'price' => 'Price',
	'name' => 'Name',
	'url' => 'URL',
	'image_address' => 'Image Address',
	'template_id'  =>  'Template ID',
	'calculated_value'  =>  'Calculated Value',
	'stage'  =>  'Stage',
	'processed_date' => 'Processed Date'
);
fputcsv($fp2, $csvData2);
fclose($fp2);
$fp3 = fopen('/home/mitesh/postcard_script/filtered_leads.csv', 'a');
fputcsv($fp3, $csvData2);
fclose($fp3);

try {
	$link = connectHLDB();
	$sql = getLeadQuery("sent");

	$ret = pg_query($link, $sql);
	if(!$ret) {
		echo "Unable to fetch data from HL DB\n";
		echo pg_last_error($link);
	} else {
		$fp = fopen('/home/mitesh/postcard_script/sample.csv', 'a');
		$fp2 = fopen('/home/mitesh/postcard_script/leads.csv', 'a');
		$fp3 = fopen('/home/mitesh/postcard_script/filtered_leads.csv', 'a');
		$index = 1;
		$sentindex = 1;
		while($row = pg_fetch_assoc($ret)) {
			if($index % 2 == 0)  {
				$template = 2;
			} else {
				$template = 1;
			}
			$data = [];
			$data['id'] = $row['id'];
			$idString = strval($row['id']);
			if (endsWith($idString, '1')) {
				$data['status'] = "skipped";
			} elseif (endsWith($idString, '2')) {
				$data['status'] = "skipped";
			} else {
				$data['status'] = "sent";
			}
			$data['address'] = $row['address'];
			$data['city_name'] = ucfirst(strtolower($row['city_name']));
			$data['state_name'] = $row['state_name'];
			$data['zip_code'] = $row['zip_code'];
			$data['price'] = $row['price'];
			$data['name'] = $row['name'];
			$data['url'] = str_replace(' ', '', 'homelightoffers.com/'.$row['name']);
			$imageadd = str_replace(" ","%20", $row['address']);
			$imagename = str_replace(' ', '_', strtolower($row['name']));
			// $data['image_address'] = $row['address'];
			$data['image_address'] = GetAddress($imageadd, $imagename);
			echo "image_address: ".$data['image_address']."\n";
			$data['template'] = $template;
			$data['calculated_value'] = $row['calculated_value'];
			$data['stage'] = $row['stage'];
			$data['processed_date'] = date("d-m-Y");
			$slashtag = str_replace(' ', '', $row['name']);
			$destination_url = 'https://track.homelightaffiliates.com/aff_ad?campaign_id=166&hostNameId=20927&aff_id=214&source=aff-lob&aff_sub=Seller-Postcard-V1-June-2022&aff_sub2='.$slashtag.'&aff_unique1=1021578&aff_unique2='.rawurlencode($row['name']).'&aff_unique4='.$row['phone'].'&aff_unique5='.rawurlencode($row['address']);
			$csvData = array(
				'slashtag' => $slashtag,
				'destination_url'  =>  $destination_url
			);
			$leadExists = checkLead($data['id']);
			// $leadExists = false;
			if(!empty($row['address']) && !$leadExists && $data['status'] == "sent"){
				array2Table($data, $option, $template);
				fputcsv($fp, $csvData);
				fputcsv($fp2, $data);
				if ($option !== "test") {
					insertLead($data);
				}
				$sentindex++;
			}
			if(!empty($row['address']) && !$leadExists && $data['status'] == "skipped"){
				fputcsv($fp3, $data);
				if ($option !== "test") {
					insertLead($data);
				}
			}
			if($sentindex > 500) {
				echo "Reached 500 leads"."\n";
				break;
			}
			$index++;
		}
		fclose($fp);
		fclose($fp2);
		fclose($fp3);
		$response = uploadCSV();
		print_r($response);
	}
	pg_close($link);
}

catch (Exception $e) {
 echo "error $e"; // Something went wrong. Examine $e->body['error_description'] for a description of the error.
 error_log("ERROR::::$e");
}

function debug($data) {
	/*echo '<pre>';
	print_r($data);
	echo '</pre>';*/
}

function escape($string) {
	return htmlspecialchars($string, ENT_QUOTES);
}

function GetAddress($address, $name){
	$ch = curl_init();
	$curlConfig = array(
	   CURLOPT_URL => "https://maps.googleapis.com/maps/api/streetview?size=1200x688&location=".$address."&key=AIzaSyChQFYZVaMnvY1S-WKTiYpFQwvsC3GTcTY",
	   CURLOPT_RETURNTRANSFER => true,
	   CURLOPT_HTTPHEADER => array("Content-Type: application/json;charset=utf-8")
	);
	echo "address: ".$address."\n";
	echo "name: ".$name."\n";
	curl_setopt_array($ch, $curlConfig);
	$resImage = curl_exec($ch);
    $fileSize = curl_getinfo($ch, CURLINFO_CONTENT_LENGTH_DOWNLOAD);
	curl_close($ch);
	$defaultImg = "https://storage.googleapis.com/image_address/default/seller_creative_1.jpg";
	if ($fileSize < 25000) {
		return $defaultImg;
	}
	$uploadedImg = uploadImage($resImage, $name);
	$uploadedImg = json_decode($uploadedImg);
	$img = "https://storage.googleapis.com/image_address/".$uploadedImg->name;
	return $img;
}

function array2Table($data, $option, $template) {
	if ($option == "test") {
		$api = "test_dd438436575cdda63d0e202e4de16333383";
		$backtmp="tmpl_a4c4a79efbc060d";
		$fronttmp = ($template == 1) ? "tmpl_0999efbd5e22c2b" : "tmpl_31f90d61a284796";
	} else {
		$api = "live_ea493f2324b698812472c9afd74e848d2a7";
		$backtmp="tmpl_effd3718db19aee";
		$fronttmp = ($template == 1) ? "tmpl_e5ca5527cd5d6ee" : "tmpl_37cface8d919022";
	}
	$phone = ($template == 1) ? "(855) 950-3685" : "(855) 925-5290";
	$namefrom ='HomeLight, Inc.';
	$addressline1from ='100 California, Ste 800';
	$addressline2from ='';
	$addresscityfrom ='San Francisco';
	$addressstatefrom ='CA';
	$addresszipfrom ='94111';

	$json_more_than_value = json_decode(file_get_contents('/home/mitesh/postcard_script/more_than.json'));
	$fp1 = fopen('/home/mitesh/postcard_script/template_urls.csv', 'a');
	$addressline = trim($data['address']);
	$mailingaddress = trim($data['address']);
	$mailingcity = trim( $data['city_name']);
	$mailingstate = trim($data['state_name']);
	$mailingzip = trim($data['zip_code']);
	$morethanvalue = $json_more_than_value->{$mailingzip};
	$name = trim($data['name']);
	$url = trim($data['url']);
	$name = "$name";
	$addressline1 = $mailingaddress;
	$addressline2 = "";  
	$addresscity = $mailingcity;
	$addressstate = $mailingstate;
	$addresszip = $mailingzip;
	$imageAddress = $data['image_address'];
	$street2 = "$addressline";   // 
	$letters = array(
		'description' => $name,
		'to[name]'  =>  $name,
		'to[address_line1]' => $addressline1,
		'to[address_city]' => $addresscity,
		'to[address_state]' =>  $addressstate,
		'to[address_zip]' =>  $addresszip,
		'to[address_country]' =>  'US',
		'from[name]' => $namefrom,
		'from[address_line1]' => $addressline1from,
		'from[address_city]'  =>  $addresscityfrom,
		'from[address_state]' =>  $addressstatefrom,
		'from[address_zip]' =>  $addresszipfrom,
		'from[address_country]' =>  'US',
		'size' => '4x6',
			'front'              => "$fronttmp",   
			'back'               => "$backtmp", 
		
		'merge_variables[url]' => "$url", 
		'merge_variables[image_address]' => $imageAddress,
		'merge_variables[address]' => "$street2",
		'merge_variables[phone_number]' => "$phone",//"760-334-5405",
		'merge_variables[amount]' => "$morethanvalue",
		'mail_type'       => 'usps_first_class'
	);
	$result = post($api, 'postcards', $letters);
	print_r($result);
	$csvData = array(
		'name' => $result->description,
		'url'  =>  $result->url,
		'template'  =>  $template
	);
	fputcsv($fp1, $csvData);
	error_log("paso 1");
	fclose($fp1);
}

function remote_file_exists($url) {
	$ch = curl_init($url);
	curl_setopt($ch, CURLOPT_NOBODY, true);
	curl_exec($ch);
	$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
	curl_close($ch);
	if( $httpCode == 200 ){return true;}
}

function formatMoney($number, $fractional=false) {
    if ($fractional) {
        $number = sprintf('%.2f', $number);
    }
    while (true) {
        $replaced = preg_replace('/(-?\d+)(\d\d\d)/', '$1,$2', $number);
        if ($replaced != $number) { 
            $number = $replaced; 
        } else {
            break;
        }
    }
    return $number;
}

function uploadImage($resImage, $name) {
	$curl = curl_init();
	$access_token = file_get_contents("/home/mitesh/postcard_script/access_token.txt");
	$token_array = explode("..................", $access_token, 2);
	$access_token = $token_array[0];

	curl_setopt_array($curl, array(
	CURLOPT_URL => 'https://storage.googleapis.com/upload/storage/v1/b/image_address/o?uploadType=media&name=street_images/'.$name.'.jpg',
	CURLOPT_RETURNTRANSFER => true,
	CURLOPT_ENCODING => '',
	CURLOPT_MAXREDIRS => 10,
	CURLOPT_TIMEOUT => 0,
	CURLOPT_FOLLOWLOCATION => true,
	CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
	CURLOPT_CUSTOMREQUEST => 'POST',
	CURLOPT_POSTFIELDS => $resImage,
	CURLOPT_HTTPHEADER => array(
		'Authorization: Bearer '.$access_token,
		'Content-Type: image/jpg'
	),
	));
	$response = curl_exec($curl);
	print_r($response);
	$uploadedImg = json_decode($response);
	if (!(isset($uploadedImg->name))) {
		echo "Access Token expired"."\n";
		accessToken();
		$uploadedImg = uploadImage($resImage, $name);
		return $uploadedImg;
	}
	curl_close($curl);
	return $response;
}

function accessToken() {
	echo "Creating access token"."\n";
	$output=null;
	$retval=null;
	exec('gcloud auth application-default print-access-token > /home/mitesh/postcard_script/access_token.txt', $output, $retval);
}

function post($api_key, $endpoint, $data = []) {
  $ch = curl_init('https://api.lob.com/v1/' . $endpoint);
  curl_setopt($ch, CURLOPT_USERPWD, $api_key . ":");
  curl_setopt($ch, CURLOPT_TIMEOUT, 30);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
  curl_setopt($ch, CURLOPT_POST, 1);
  curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));
  $response = curl_exec($ch);
  curl_close($ch);

  return json_decode($response);
}

function endsWith( $haystack, $needle ) {
    $length = strlen( $needle );
    if( !$length ) {
        return true;
    }
    return substr( $haystack, -$length ) === $needle;
}

function uploadCSV() {
	$curl = curl_init();
	curl_setopt_array($curl, array(
	  CURLOPT_URL => 'https://homelight-021622-directmail-linkredirection-cloud-772nj4albq-uc.a.run.app/addRecords',
	  CURLOPT_RETURNTRANSFER => true,
	  CURLOPT_ENCODING => '',
	  CURLOPT_MAXREDIRS => 10,
	  CURLOPT_TIMEOUT => 0,
	  CURLOPT_FOLLOWLOCATION => true,
	  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
	  CURLOPT_CUSTOMREQUEST => 'POST',
	  CURLOPT_POSTFIELDS => array(''=> new CURLFILE('/home/mitesh/postcard_script/sample.csv')),
	));
	$response = curl_exec($curl);
	curl_close($curl);
	echo $response;
}

function connectHLDB() {
	$_SERVER['RDS_HOSTNAME'] = "host = ec2-35-175-95-175.compute-1.amazonaws.com";
    $_SERVER['RDS_USERNAME'] = "billraney";
    $_SERVER['RDS_PASSWORD'] = "pe068a5b2c0af335c88be9fe69bb990e625c999078e889bdc42fcdda6a070c4e4";
    $_SERVER['RDS_DB_NAME'] = "dbname = df7dcqko0grlec";
	$credentials = "user = billraney password=pe068a5b2c0af335c88be9fe69bb990e625c999078e889bdc42fcdda6a070c4e4";
	$port = "port = 5432";
	$link = pg_connect($_SERVER['RDS_HOSTNAME'].' '.$port.' '.$_SERVER['RDS_DB_NAME'].' '.$credentials);
	if(!$link) {
		echo "Unable to connect to DB 1\n";
		return false;
	} else {
		echo "Connected to DB 1\n";
		return $link;
	}
}

function connectGCPDB() {
	$_SERVER['RDS_HOSTNAME'] = "host = 34.68.175.210";
    $_SERVER['RDS_USERNAME'] = "postgres";
    $_SERVER['RDS_PASSWORD'] = "password";
    $_SERVER['RDS_DB_NAME'] = "dbname = dm_query_ps";
	$credentials = "user = postgres password=password";
	$port = "port = 5432";
	$link = pg_connect($_SERVER['RDS_HOSTNAME'].' '.$port.' '.$_SERVER['RDS_DB_NAME'].' '.$credentials);
	if(!$link) {
		echo "Unable to connect to DB 2\n";
		return false;
	} else {
		echo "Connected to DB 2\n";
		return $link;
	}
}

function checkLead($leadId) {
	$link = connectGCPDB();
	if ($link) {
		$sql = "select * from postcard_details WHERE status = 'sent' and lead_id = ".$leadId;
		$ret = pg_query($link, $sql);
		if(!$ret) {
			echo pg_last_error($link);
		} else {
			$row = pg_fetch_assoc($ret);
			if(!$row) {
				echo "This is new lead\n";
			} else {
				echo "Postcard already sent to this lead\n";
				return true;
			}
		}
	}
	return false;
}

function insertLead($data) {
	$link = connectGCPDB();
	if ($link) {
		$sql = "INSERT INTO postcard_details (lead_id, status, address, city_name, state_name, zip_code, price, lead_name, url, image_address, calculated_value, stage, processed_date) VALUES (".$data['id'].",'".$data['status']."','".$data['address']."','".$data['city_name']."','".$data['state_name']."','".$data['zip_code']."',".$data['price'].",'".$data['name']."','".$data['url']."','".$data['image_address']."','".$data['calculated_value']."','".$data['stage']."', NOW())";

		$ret = pg_query($link, $sql);
		if(!$ret) {
			echo "Lead not created\n";
			echo pg_last_error($link);
		} else {
			echo "Lead created\n";
			return true;
		}
	}
	return false;
}

function getLeadQuery($status) {
	$sql = "select *
	from leads
	where user_type = 'seller'
	and source_form in ('external','simple-sale-v1-5-property-picker','simple-sale-v1-5','simple-sale-v1-4','simple-sale-v1-3','simple-sale-v1-2','simple-sale-v1-1','simple-sale-v1','simple-sale-manual-estimate-v1-0','simple-sale-blind-intro')
	and stage in ('called_busy','called_left_msg','called_no_msg','new','vm_not_set_up')
	and created_at >= NOW() - '3 days'::INTERVAL
	and zip_code in ('91910','92101','92126','91911','92592','92109','92021','92154','92104','92115','92130','92105','92122','92117','92128','92020','92056','92071','92024','92057','92103','92037','91977','92078','92026','92114','92028','91942','92129','92111','91950','92027','92116','92009','92672','92054','92127','92064','91913','92040','92069','92025','92084','92019','92058','92102','92108','92107','92065','92113','92120','92131','91941','92110','92123','92008','92083','92124','92081','92139','91915','92011','91932','92119','92118','91945','92106','92029','92173','92010','92014','92075','91901','91902','92007','92067','92143','91912','91935','91978','92003','92004','92036','92121','92085','92153','91906','92023','92112','91980','92138','92150','91951','92178','92163','92052','92018','92061','92079','92038','92196','92192','92088','91921','92169','92072','92198','91916','92046','91962','92170','92174','91903','92051','91909','92033','92030','92022','91905','92195','91933','92086','92176','91979','91944','92165','92177','92168','92171','92074','91908','92172','92070','92193','92167','92013','91946','92160','91963','92175','92049','92159','92137','92039','92059','91917','92142','92191','91943','91976','92060','92145','92066','91931','91948','92140','92055','91990','91987','92090','92092','92093','92096','91947','92132','92133','92134','92135','92136','92147','92152','92155','92158','92161','92162','92164','92179','92182','92184','92186','92187','92190','92194','92197','92199','92082','91914','92091','92166','92068','91934','92149','92679','92651','92637','92630','92610','92618','92603','92657','92590','92562','92591','92536','92544','92543','92596','92595','92539','92584','92586','92585','95376','95377','95304','95391','95336','95337','95330','95366','95201','95202','95203','95204','95205','95206','95207','95208','95209','95210','95211','95212','95215','95219','95350','95351','95352','95353','95354','95355','95356','95357','95358','95397','94550','94551','94568','94501','95368','92656','92801','92802','92803','92804','92805','92806','92807','92808','92809','92812','92814','92815','92816','92817','92825','92831','92832','92850','92870','92880','92889','92821','92822','92823','92886','90620','90621','90622','90623','90624','92626','92627','92628','92646','92707','90630','90720','92624','92629','92728','90631','92833','92834','92835','92836','92837','92838','90680','92703','92840','92841','92842','92843','92844','92845','92846','90742','92605','92615','92647','92648','92649','92602','92604','92606','92612','92614','92616','92617','92619','92620','92623','92650','92697','92782','90632','90633','92652','92653','92654','92607','92677','92698','92609','92691','90721','90815','92690','92692','92625','92658','92659','92660','92661','92662','92663','92705','92706','92856','92857','92859','92861','92863','92864','92865','92866','92867','92868','92869','92811','92871','92688','92673','92674','92675','92693','92701','92702','92704','92711','92712','92735','92799','90740','90743','92683','92780','92781','92655','92684','92685','92885','92887','92881','92882','92883','92879','92860','92503','91710','91708','91709','90745','90746','90755','90802','90803','90804','90805','90806','90807','90808','90810','80913','90914','90822','90831','90833','90701','90703','90638','90712','90713','90715','90716','91750','91711','91724','91741','91740','91773','91722','91723','91745','91746','91748','91788','91789','91792','91010','91763','91784','91785','91786','91743','91758','91761','91762','91764','91766','91767','91768','91769','91701','91730','91737','91739','92284','92301','92307','92308','92313','92316','92324','92336','92337','92344','92345','92346','92394','92395','92397','92401','92403','92404','92405','92407','92408','92410','92411','92376','92377','92507','92551','92553','95555','92571','92354','92359','92373','92374','92392','92399','92223','92320','92220','92563','92509','92335','91797','91793','91791','91790','91765','91752','91716','91702','91017','91016','91008','91007','91006','90601','90240','90033','90008','90241','90604','90605','90640','90019','91744','90242','90606','90016','90018','90059','90602','90650','90660','90670','91024','92708','92506','90004','90005','90024','90025','90026','90027','90028','90029','90031','90032','90034','90035','90036','90038','90039','90041','90043','90044','90045','90046','90047','90048','90049','90056','90062','90064','90065','90066','90067','90068','90069','90077','90094','90211','90212','90230','90231','90232','90245','90248','90250','90254','90260','90266','90272','90277','90278','90291','90292','90293','90301','90302','90303','90304','90305','90401','90402','90403','90404','90405','90501','90502','90503','90504','90505','90006','90007','90012','90057','90210','91401','91403','91405','91423','91504','91505','91506','91601','91602','91604','91605','91606','94611','94530','94541','94605','94666','94577','94608','94619','94546','94545','94542','64602','94553','94607','94578','94509','94544','94561','94565','94579','94580','94601','94602','94603','94606','94610','94612','94615','94618','94621','94646','94702','94703','94705','94805','95035','95131','95132','95133','95135','94597','94801','91311','91324','91607','93065','90265','91367','93030','93010','91304','90247','91356','91364','91302','93012','93035','91377','93004','93041','90603','90651','90652','90813','90814','90275','90274','90732','90733','90734','90731','90717','90710','90748','90744','90507','90508','90509','90510','90749','90267','90801','90809','90832','90842','90844','90846','90847','90848','90853','90261','90506','90747','90249','90895','90251','90296','90220','90840','90061','90221','90295','90223','90224','90311','90306','90307','90308','90309','90310','90312','90294','90222','90711','90714','90406','90407','90408','90409','90410','90411','90002','90723','90262','90003','90706','90233','90707','90280','90001','90264','90037','90263','90255','90073','90084','90089','90011','90239','90095','90202','90201','90058','90270','90209','90213','90015','90021','90010','90023','90014','90020','90040','90017','90070','90091','90013','90071','90030','90050','90051','90052','90053','90054','90055','90060','90072','90074','90075','90076','90078','90080','90081','90082','90083','90086','90087','90088','90093','90009','90022','90042','90063','90090','90290','92676','92678','92694','92709','92710','92725','92862','92899','95624','95757','95758','95630','95864','95608','95829','95828','95835','95833','95762','95628','95648','95765','95677','95747','95746','95678','95661','95650','95663','95602','95603','95709','95610','95621','95713','95614','95619','95623','95631','95633','95634','95945','95636','95720','95651','95655','95652','95722','95658','95662','95664','95666','95667','95668','95726','95670','95742','95672','95811','95814','95816','95818','95819','95822','95825','95831','95682','95683','95684','95817','95820','95821','95823','95826','95827','95830','95834','95841','95842','95605','95691','95616','95618','95693','90607','90608','90609','90610','90637','91770','91775','92757','82688','92810','92210','92211','92234','92236','92253','92255','92558','92260','92261','92262','92263','92264','92270','92292','92502','92504','92505','92508','92513','92514','92515','92516','92517','92518','92519','92530','92531','92532','92545','92546','92548','92552','92554','92555','92556','92557','92564','92570','92572','92587','92593','92877','92878','91729','91307','91308','91314','91315','91316','91317','91318','91321','91325','91336','91337','91339','91340','91345','91346','91347','91352','91354','91359','91373','91374','91375','91376','91378','91382','91385','91386','91391','91392','91393','91394','91397','91399','91402','91404','91406','91407','91408','91410','91411','91412','91413','91424','91425','91426','91427','94536','94538','94539','94552','94555','94560','94566','94582','94583','94587','94588','91030','91108','91706','91731','91732','91733','91754','91756','91776','91780','91801','91803','91350','91351','91355','91381','91384','91387','91390','94591','93635','95328','95237','95388','95326','95367','95380','95324','95688','95341','95242','95301','95363','95319','93610','95320','95240','95348','95315','95230','95334','95323','95316','95382','95386','95307','95329','95361','94513','95640','95228','95252','95370','93710','95815','95660','95843','95220','95626','95690','95673','95838','95612','95615','95620','95632','95635','95638','95639','95645','95659','95669','95674','95681','9568','95692','95703','95776','95824','95832','95837','95949','9596','95975','95977','95991','94507','94517','94518','94519','94520','94521','94522','94524','94527','94529','94526','94528','94549','94556','94570','94575','94563','94523','94595','94596','94598','94502','94706','94701','94704','94707','94708','94709','94712','94720','94516','94525','94803','94820','94662','94604','94613','94614','94617','94622','94623','94624','94649','94659','94660','94661','94620','94564','94569','94802','94804','94807','94808','94850','94572','94806','94531','96001','96002','96003','96007','96008','96019','96022','96051','96062','96073','96087','96088','95927','95926','95928','95938','95942','95969','95973','96080','96035','96021','95963','92356','92342','92371','92372','92311','94110','94131','94127','94114','94112','94132','94116','94122','94121','94118','94117','94115','94960','94939','94904','94930','94925','94941','94963','94901','94903','94973','94070','94061','94062','94063','94065','94002','94401','94402','94403','94404','94010','94025','94027','92854','95002','95008','95013','95101','95110','95111','95112','95113','95116','95117','95118','95119','95120','95121','95122','95123','95124','95125','95126','95127','95128','95129','95130','95134','95136','95138','95139','95141','95148','94109','94124','94103','94134','95401','95403','95404','95405','95407','95409','95492','95448','95472','94928','94931','94951','95444','95452','94952','94954','95476','95436','91608','91001','91102','91003','91105','91011','91020','91121','91123','91126','91101','91104','91106','91107','91214','91755','91188','91189','91116','91117','91124','91125','91182','91184','91199','91031','91103','91759','92201','92203','92225','92230','92239','92240','92241','92242','92252','92254','92256','92258','92267','92268','92274','92276','92277','92278','92280','92282','92285','92304','92305','92309','92310','92314','92315','92321','92322','92325','92327','92332','92333','92338','92339','92341','92347','92352','92358','92363','92364','92365','92368','92378','92382','92385','92386','92391','92398','92501','92549','92561','92567','92582','92583','93562','93592','93551','92318','92334','92402','92406','92413','92510','92511','92512','92581','93309','93311','93306','93312','93313','93314','93308','91301','91303','91306','91320','91326','91331','91335','91342','91343','91344','91360','91361','91362','91436','91501','91502','93021','93063','90702','90639','90671','94609','94710','91040','91041','91042','91043','91046','91201','91202','91203','91204','91205','91206','91207','91208','91209','91210','91221','91222','91224','91225','91226','91305','91309','91313','91327','91328','91329','91330','91333','91334','91341','91353','91357','91365','91371','91372','91395','91396','91409','91416','91470','91482','91495','91496','91499','91503','91507','91508','91510','91521','91522','91523','91526','91603','91609','91610','91611','91612','91614','91615','91616','91617','91618','93101','93102','93103','93105','93106','93230','93245','93291','93292','93277','93274','93611','93612','94510','94512','94533','94534','94535','94571','94585','94589','94590','94592','95625','95687','95696','94503','94508','94515','94558','4559','94562','94567','94573','94574','94576','94581','94599','95695','94505','94506','94511','94514','94547','94548','94537','94540','94543','94557','94586','94203','94204','94205','94206','94207','94208','94209','94211','94229','94230','94232','94234','94235','94236','94237','94239','94240','94244','94245','94247','94248','94249','94250','94252','94254','94256','94257','94258','94259','94261','94262','94263','94267','94268','94269','94271','94273','94274','94277','94278','94279','94280','94282','94283','94284','94285','94287','94288','94289','94290','94291','94293','94294','94295','94296','94297','94298','94299','95609','95611','95641','95671','95680','95741','95759','95763','95812','95813','95836','95840','95851','95852','95853','95860','95865','95866','95867','95894','95899','95213','95214','95267','95269','95296','95297','95378','95037','95050','95051','95114','93401','93402','93405','93412','93420','93421','93422','93423','93424','93428','93430','93435','93442','93443','93444','93446','93447','93448','93449','93453','92521','92522','92599','92589','91751','95961','75014','75015','75016','75017','75038','75039','75042','75045','75059','75060','75061','75062','75063','75050','75051','75052','75054','75071','75080','75081','75083','75085','75104','75106','75115','75116','75123','75137','75138','75146','75154','75165','75225','75230','75231','75232','75237','75238','75240','75243','75249','75251','75254','75261','75354','75355','75367','75368','75374','75382','75392','75454','76001','76002','76003','76004','76005','76006','76007','76010','76011','76012','76013','76014','76015','76016','76017','76018','76019','76058','76094','76096','76008','76009','76020','76053','76054','76098','76021','76022','76095','76028','76097','76031','76033','76034','76036','76039','76040','76051','76099','76052','76060','76061','76063','76065','76084','76092','76101','76102','76103','76104','76105','76106','76107','76109','76110','76111','76112','76113','76114','76115','76116','76118','76119','76120','76121','76122','76123','76124','76126','76129','76130','76131','76132','76133','76134','76135','76136','76137','76140','76147','76148','76150','76155','76161','76162','76163','76164','76166','76177','76179','76181','76185','76190','76191','76192','76193','76195','76196','76197','76198','76199','76117','76127','76180','76182','76234','76244','76248','76262','76044','76071','75067','75019','75099','78299','78201','78202','78203','78204','78205','78206','78207','78208','78209','78210','78211','78212','78213','78214','78215','78216','78217','78218','78219','78220','78221','78222','78223','78224','78225','78226','78227','78228','78229','78230','78231','78232','78233','78234','78235','78236','78237','78238','78239','78240','78241','78242','78243','78244','78245','78246','78247','78248','78249','78250','78251','78252','78253','78254','78255','78256','78257','78258','78259','78260','78261','78262','78263','78264','78265','78266','78268','78269','78270','78275','78278','78279','78280','78283','78284','78285','78286','78287','78288','78289','78291','78292','78293','78294','78295','78296','78297','78298','77016','77076','77018','77092','77055','77026','77009','77008','77007','77004','77021','77033','77023','77373','77379','77087','77494','77411','77479','77459','77096','77478','77386','77469','77493','77461','77471','77417','77406','77410','77429','77433','77474','77423','77485','77401','77057','77027','77025','77043','77019','77098','77030','77054','77051','77047','77077','77450','77449','77441','77407','77079','77094','77024','77550','77551','77554','77002','77003','77005','77006','77010','77011','77015','77020','77022','77031','77034','77035','77036','77040','77042','77084','77085','77088','77089','77091','77095','77099','77339','77346','77375','77377','77380','77381','77382','77384','77385','77388','77389','77402','77477','77487','77489','77492','77495','77496','77502','77503','77504','77505','77506','77507','77511','77518','77536','77539','77565','77571','77573','77578','77581','77583','77584','77586','77587','77588','77598','77045','77046','77048','77053','77056','77058','77059','77061','77062','77063','77064','77065','77066','77067','77068','77070','77071','77072','77074','77075','77081','77082','77083','77029','77517','77546','77563','77568','77590','77591','75001','75002','75006','75007','75009','75010','75011','75013','75022','75023','75024','75025','75026','75027','75028','75029','75030','75032','75034','75035','75037','75040','75041','75043','75044','75046','75047','75048','75049','75053','75056','75057','75065','75068','75069','75070','75074','75075','75077','75078','75082','75086','75087','75088','75089','75093','75094','75097','75098','75101','75114','75118','75119','75120','75121','75124','75125','75126','75132','75134','75135','75141','75142','75143','75147','75148','75149','75150','75152','75155','75156','75157','75158','75159','75160','75161','75163','75164','75166','75167','75168','75172','75173','75180','75181','75182','75185','75187','75189','75201','75202','75203','75204','75205','75206','75207','75208','75209','75210','75211','75212','75214','75215','75216','75217','75218','75219','75220','75221','75222','75223','75224','75226','75227','75228','75229','75233','75234','75235','75236','75241','75242','75244','75245','75246','75247','75248','75250','75252','75253','75258','75260','75262','75263','75264','75265','75266','75267','75270','75275','75277','75283','75284','75285','75286','75287','75301','75303','75310','75312','75313','75315','75320','75323','75326','75334','75336','75339','75340','75342','75343','75344','75356','75357','75358','75359','75360','75370','75371','75372','75373','75376','75378','75379','75380','75381','75387','75389','75390','75391','75393','75394','75395','75397','75398','75401','75402','75403','75404','75407','75409','75422','75423','75424','75428','75429','75442','75453','75458','75474','75485','75496','75751','75752','75756','75758','75770','75778','75782','76041','76064','76201','76202','76203','76204','76205','76206','76207','76208','76209','76210','76226','76227','76247','76249','76258','76259','76266','76623','76651','76670','78015','78006','78023','78002','78130','78108','78666','78132','78133','78070','78163','78131','78623','78135','78154','78155','78121','78648','78124','78123','78655','78638','78156','78661','78670','78115','78004','78074','78027','78013','78114','78143','78161','78147','78113','78140','78160','78101','78064','78062','78008','78012','78050','78011','78069','78026','78052','78073','78065','78009','78886','78861','78850','78066','78059','78056','78039','78016','78003','78885','78883','78884','78055','78063','78701','78702','78703','78704','78705','78745','78748','78749','78739','78737','78736','78735','78738','78733','78746','78744','78747','78719','78742','78725','78721','78723','78751','78752','78724','78754','78753','78756','78731','78730','78732','78726','78750','78759','78727','78729','78728','78717','78613','78757','78722','76108','75140','76511','76518','76527','76530','76537','76574','76577','76578','78602','78605','78610','78611','78612','78615','78616','78617','78619','78620','78621','78626','78628','78633','78634','78636','78640','78641','78642','78644','78645','78650','78652','78653','78654','78656','78659','78660','78662','78663','78664','78665','78669','78674','78676','78681','78712','78734','78741','78755','78758','78774','78941','78947','78953','78957','78310','78606','75033','75072','33844','33812','33813','33803','33880','32765','33896','33897','32836','34746','34747','34743','34758','34759','34786','34741','34787','33881','33884','32779','33823','32832','34772','32835','32824','34744','34711','34734','32828','32839','33572','33598','33570','33578','33579','34221','33573','34219','33613','33618','33624','33625','33626','33621','33606','33602','33619','33605','33603','33610','33634','33615','33635','33614','33607','33609','33629','33611','33616','33604','33617','33637','33620','33647','33510','33511','33569','33563','33594','33596','33584','33534','34231','34232','34233','34235','34236','34237','34238','34239','34240','34241','34242','34243','33919','33912','33908','33901','33909','33990','33903','33991','33993','33914','33904','33956','33922','33907','33966','33916','33905','33967','33543','33544','33545','34638','34639','34637','33559','33558','33548','33549','33568','34677','33547','33576','34604','34608','34607','34606','34609','34611','34652','34653','34654','34655','34656','34668','34667','34674','34669','34683','34688','34689','33556','34685','34684','34690','34691','34698','33763','33076','33063','33073','33067','33071','33065','33427','33429','33431','33433','33434','33481','33486','33487','33496','33499','33424','33425','33426','33436','33483','33064','33028','33029','33027','33024','33330','33331','33332','32210','32218','32244','32256','32246','32225','32216','32224','32257','32207','32258','32209','32250','32205','32211','32208','32277','32221','32233','32223','32217','32226','32206','32222','32254','32219','32220','32204','32266','32234','32202','32203','32241','32245','32236','32239','32227','32238','32247','32255','32240','32235','32212','32201','32229','32228','32099','32214','32215','32230','32232','32231','32237','32276','32267','32290','32259','32092','32084','32086','32082','32080','32003','32081','32095','32145','32033','32085','32004','32260','32114','32116','32115','32118','32117','32119','32120','32121','32122','32123','32124','32125','32126','32127','32128','32129','32132','32141','32168','32169','32170','32173','32174','32175','32176','32409','32404','32466','32444','32407','32408','32413','32401','32405','323086','32097','32034','32065','32073','32068','85233','85234','85295','85296','85297','85298','85299','85224','85225','85226','85244','85246','85248','85249','85286','85142','85240','85242','85243','85201','85202','85203','85204','85205','85206','85207','85208','85209','85210','85211','85212','85213','85117','85118','85119','85120','85178','85250','85251','85252','85254','85255','85256','85257','85258','85259','85260','85261','85262','85345','85380','85381','85382','85383','85385','85140','85143','85032','85281','85308','85280','85282','85283','85284','85285','85287','85001','85002','85003','85004','85005','85006','85007','85008','85009','85010','85011','85012','85013','85014','86001','86003','86004','86005','86018','86015','85027','85033','85037','85043','85053','85083','85097','85301','85302','85303','85304','85305','85306','85307','85309','85310','85326','85335','85338','85339','85340','85351','85353','85355','85363','85373','85374','85375','85379','85387','85388','85392','85395')";
	return $sql;
}
?>
